<template>
  <q-layout view="hHh lpr fFf">
    <q-header elevated class="bg-primary text-white" height-hint="98">
      <q-toolbar>
        <q-toolbar-title>
          <q-avatar>
            <img src="data:image/jpeg;base64,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" />
          </q-avatar>
          Finanzas personales
        </q-toolbar-title>

        <q-btn
          flat
          dense
          icon="logout"
          label="Salir"
          color="white"
          @click="logout"
        />
      </q-toolbar>

      <q-tabs align="left">
        <q-route-tab to="principal" label="Inicio" />
        <q-route-tab to="cuentas" label="Cuentas" />
        <q-route-tab to="movimientos" label="Movimientos" />
        <q-route-tab to="metas" label="Metas" />
      </q-tabs>
    </q-header>

    <q-page-container>
      <router-view />
    </q-page-container>
  </q-layout>
</template>

<script setup>
import { useAuthStore } from "stores/auth.js";
import { useRouter } from "vue-router";
import { useQuasar, Cookies } from "quasar";
import { onMounted } from "vue";

const authStore = useAuthStore();
const router = useRouter();
const $q = useQuasar();

onMounted(async () => {
  router.beforeEach(async (to, from, next) => {
    const isAuthenticated = !!Cookies.get("authorization_token");
    if (to.fullPath === "/") {
      await authStore.logout();
    }
    if (to.meta.requiresAuth && !isAuthenticated) {
      next("/");
    } else {
      next();
    }
  });
});

function logout() {
  $q.dialog({
    title: "Cierre de sesión",
    message: "Usted esta saliendo de la aplicación",
    ok: "Continuar",
    cancel: "Cancelar",
  })
    .onOk(() => {
      authStore.logout();
      router.push("/");
    })
    .onCancel(() => {
      router.currentRoute;
    });
}
</script>
